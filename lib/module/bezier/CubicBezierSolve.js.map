{"version":3,"sources":["CubicBezierSolve.ts"],"names":["Animated","find","acos","approximates","Value","and","cond","divide","add","multiply","block","greaterThan","eq","lessThan","pow","sqrt","set","sub","cos","not","isRootValidForCubicBezier","root","cuberoot","v","cubicBezierSolve","pa","pb","pc","pd","a","b","c","d","root1","root2","root3","q","q2","p","p3","discriminant","mp3","mp33","r","t","cosphi","phi","crtr","t1","u1","sd","v1","sq","Math","PI"],"mappings":"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","sourcesContent":["import Animated from \"react-native-reanimated\";\n\nimport { find } from \"../Array\";\nimport { acos, approximates } from \"../Math\";\n\nconst {\n  Value,\n  and,\n  cond,\n  divide,\n  add,\n  multiply,\n  block,\n  greaterThan,\n  eq,\n  lessThan,\n  pow,\n  sqrt,\n  set,\n  sub,\n  cos,\n  not\n} = Animated;\n\nconst isRootValidForCubicBezier = (root: Animated.Node<number>) =>\n  and(greaterThan(root, 0), lessThan(root, 1));\n\n// pomax.github.io/bezierinfo/#extremities\nconst cuberoot = (v: Animated.Adaptable<number>) =>\n  cond(\n    lessThan(v, 0),\n    multiply(pow(multiply(v, -1), 1 / 3), -1),\n    pow(v, 1 / 3)\n  );\n\nconst cubicBezierSolve = (\n  pa: Animated.Adaptable<number>,\n  pb: Animated.Adaptable<number>,\n  pc: Animated.Adaptable<number>,\n  pd: Animated.Adaptable<number>\n): Animated.Node<number> => {\n  const a: Animated.Value<number> = new Value();\n  const b: Animated.Value<number> = new Value();\n  const c: Animated.Value<number> = new Value();\n  const d: Animated.Value<number> = new Value();\n  const root1: Animated.Value<number> = new Value();\n  const root2: Animated.Value<number> = new Value();\n  const root3: Animated.Value<number> = new Value();\n\n  const q: Animated.Value<number> = new Value();\n  const q2: Animated.Value<number> = new Value();\n  const p: Animated.Value<number> = new Value();\n  const p3: Animated.Value<number> = new Value();\n  const discriminant: Animated.Value<number> = new Value();\n\n  const mp3: Animated.Value<number> = new Value();\n  const mp33: Animated.Value<number> = new Value();\n  const r: Animated.Value<number> = new Value();\n  const t: Animated.Value<number> = new Value();\n  const cosphi: Animated.Value<number> = new Value();\n  const phi: Animated.Value<number> = new Value();\n  const crtr: Animated.Value<number> = new Value();\n  const t1: Animated.Value<number> = new Value();\n\n  const u1: Animated.Value<number> = new Value();\n\n  const sd: Animated.Value<number> = new Value();\n  const v1: Animated.Value<number> = new Value();\n  const sq: Animated.Value<number> = new Value();\n\n  return block([\n    set(a, add(multiply(3, pa), multiply(-6, pb), multiply(3, pc))),\n    set(b, add(multiply(-3, pa), multiply(3, pb))),\n    set(c, pa),\n    set(d, add(multiply(-1, pa), multiply(3, pb), multiply(-3, pc), pd)),\n    cond(\n      approximates(d, 0),\n      cond(\n        approximates(d, 0),\n        cond(not(approximates(b, 0)), set(root1, divide(multiply(-1, c), b)), [\n          set(q, sqrt(sub(pow(b, 2), multiply(4, a, c)))),\n          set(root1, divide(sub(q, b), multiply(2, a))),\n          set(root2, divide(sub(multiply(b, -1), q), multiply(2, a)))\n        ])\n      ),\n      [\n        set(a, divide(a, d)),\n        set(b, divide(b, d)),\n        set(c, divide(c, d)),\n        set(p, divide(sub(multiply(3, b), multiply(a, a)), 3)),\n        set(p3, divide(p, 3)),\n        set(\n          q,\n          divide(\n            add(multiply(2, a, a, a), multiply(-9, a, b), multiply(27, c)),\n            27\n          )\n        ),\n        set(q2, divide(q, 2)),\n        set(discriminant, add(multiply(q2, q2), multiply(p3, p3, p3))),\n        cond(\n          lessThan(discriminant, 0),\n          [\n            set(mp3, divide(multiply(p, -1), 3)),\n            set(mp33, multiply(mp3, mp3, mp3)),\n            set(r, sqrt(mp33)),\n            set(t, divide(multiply(q, -1), multiply(2, r))),\n            set(\n              cosphi,\n              cond(lessThan(t, -1), -1, cond(greaterThan(t, 1), 1, t))\n            ),\n            set(phi, acos(cosphi)),\n            set(crtr, cuberoot(r)),\n            set(t1, multiply(2, crtr)),\n            set(root1, sub(multiply(t1, cos(divide(phi, 3))), divide(a, 3))),\n            set(\n              root2,\n              sub(\n                multiply(t1, cos(divide(add(phi, 2 * Math.PI), 3))),\n                divide(a, 3)\n              )\n            ),\n            set(\n              root3,\n              sub(\n                multiply(t1, cos(divide(add(phi, 4 * Math.PI), 3))),\n                divide(a, 3)\n              )\n            )\n          ],\n          cond(\n            eq(discriminant, 0),\n            [\n              set(\n                u1,\n                cond(\n                  lessThan(q2, 0),\n                  cuberoot(multiply(q2, -1)),\n                  multiply(cuberoot(q2), -1)\n                )\n              ),\n              set(root1, sub(multiply(2, u1), divide(a, 3))),\n              set(root2, sub(multiply(-1, u1), divide(a, 3)))\n            ],\n            [\n              set(sd, sqrt(discriminant)),\n              set(u1, cuberoot(sub(sq, q2))),\n              set(v1, cuberoot(add(sq, q2))),\n              set(root1, sub(u1, v1, divide(a, 3)))\n            ]\n          )\n        )\n      ]\n    ),\n    find([root1, root2, root3], isRootValidForCubicBezier)\n  ]);\n};\n\nexport default cubicBezierSolve;\n"]}